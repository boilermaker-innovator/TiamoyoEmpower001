<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tiamoyo Update Creator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", Roboto;
            background: #f0f8ff;
            line-height: 1.6;
        }

        .header {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.4));
            z-index: 1;
        }

        .header img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .tagline {
            position: absolute;
            bottom: 40px;
            left: 0;
            right: 0;
            z-index: 2;
            text-align: center;
            padding: 20px;
            color: white;
            font-size: 32px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .button-bar {
            background: #f5f5f5;
            padding: 10px;
            text-align: right;
        }

        .button {
            background: #0077B5;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .button:hover {
            background: #005b8b;
        }

        .form-content {
            padding: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        input, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        textarea {
            height: 120px;
            resize: vertical;
        }

        .photo-status {
            margin-top: 10px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            font-size: 14px;
        }

        .photo-url {
            font-size: 12px;
            color: #28a745;
            margin: 5px 0;
        }

        .photo-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .photo-preview-item {
            position: relative;
            width: 100px;
            height: 100px;
            border-radius: 4px;
            overflow: hidden;
        }

        .photo-preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-photo {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .preview {
            display: none;
        }

        .preview.visible {
            display: block;
        }

        .tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 1px solid #eee;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            flex: 1;
            font-size: 16px;
        }

        .tab.active {
            background: #0077B5;
            color: white;
        }

        .tab-content {
            padding: 20px;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .donate-button {
            display: inline-block;
            background: #e4007e;
            color: white;
            text-align: center;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 4px;
            margin: 20px auto;
            font-weight: bold;
        }

        .donate-button:hover {
            background: #c50070;
        }

        @media (max-width: 768px) {
            .header {
                height: 300px;
            }
            .tagline {
                font-size: 24px;
                bottom: 20px;
            }
            .tab {
                padding: 8px 12px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="https://i.ibb.co/5hmHtVBV/IMG-1920.jpg" alt="Tiamoyo Project">
        <div class="tagline">Supporting Communities in Tanzania</div>
    </div>

    <div class="container">
        <div class="card">
            <div class="button-bar">
                <button class="button" onclick="loadSample()">Load Sample Update</button>
            </div>
            <div class="form-content">
                <div class="form-group">
                    <label for="title">Update Title</label>
                    <input type="text" id="title" placeholder="Enter title for your update">
                </div>

                <div class="form-group">
                    <label for="location">Location</label>
                    <input type="text" id="location" placeholder="Where did this take place?">
                </div>

                <div class="form-group">
                    <label for="story">Story</label>
                    <textarea id="story" placeholder="Share what happened..."></textarea>
                </div>

                <div class="form-group">
                    <label for="impact">Impact Details</label>
                    <textarea id="impact" placeholder="What impact did this have?"></textarea>
                </div>

                <div class="form-group">
                    <label for="prayer">Prayer Points</label>
                    <textarea id="prayer" placeholder="Share prayer points..."></textarea>
                </div>

                <div class="form-group">
                    <label for="photos">Photos (Max 6 photos, 5MB each)</label>
                    <input type="file" id="photos" multiple accept="image/*" onchange="handlePhotos(event)">
                    <div id="photoStatus"></div>
                    <div id="photoPreview" class="photo-preview"></div>
                </div>

                <button class="button" onclick="showPreview()">Preview Update</button>
            </div>
        </div>

        <div id="preview" class="card preview">
            <div class="preview-header">
                <h3 class="preview-title" id="previewTitle"></h3>
                <div class="preview-location" id="previewLocation"></div>
            </div>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('storyTab')">Story</button>
                <button class="tab" onclick="switchTab('photosTab')">Photos</button>
                <button class="tab" onclick="switchTab('impactTab')">Impact</button>
                <button class="tab" onclick="switchTab('prayerTab')">Prayer</button>
                <button class="tab" onclick="switchTab('supportTab')">Support</button>
            </div>

            <div id="storyTab" class="tab-content active"></div>
            <div id="photosTab" class="tab-content">
                <div class="photo-grid" id="photoGrid"></div>
            </div>
            <div id="impactTab" class="tab-content"></div>
            <div id="prayerTab" class="tab-content"></div>
            <div id="supportTab" class="tab-content">
                <div style="text-align: center;">
                    <h4 style="margin-bottom: 20px;">Support Our Mission</h4>
                    <p style="margin-bottom: 20px;">
                        Your support helps us continue bringing clean water and hope to communities across Tanzania.
                    </p>
                    <a href="https://tiamoyo-gdg-j919n.raisely.com/" class="donate-button" target="_blank">
                        Donate Now
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript will be in part 2 -->
</body>
</html>
<!-- Add this script section just before the closing </body> tag -->
<script>
    const IMGBB_API_KEY = '59cd5b2935b5b01bc744b5b0a1d26ee0';
    let uploadedPhotos = [];
    let rotationInterval;

    const sampleData = {
        title: "Clean Water Project Success in Moshi",
        location: "Moshi Region, Tanzania",
        story: "Today marks an incredible milestone in our well-drilling project! The entire community gathered to celebrate as clean water flowed for the first time from our newly completed well. The joy on everyone's faces was unforgettable as children helped paint the well housing with beautiful artwork representing their hopes and dreams.",
        impact: "• Over 200 families now have access to clean water\n• Water collection time reduced from 3 hours to 5 minutes\n• Local school attendance has increased by 30%\n• Community health clinic reports 45% reduction in waterborne illnesses",
        prayer: "1. Wisdom for the maintenance team as they care for the well system\n2. Protection of the well infrastructure\n3. Continued unity within the community\n4. Health improvements for all families using the well",
        photos: [
            {
                url: "https://i.ibb.co/sample-image-1",
                name: "Community gathering"
            },
            {
                url: "https://i.ibb.co/sample-image-2",
                name: "Well completion"
            }
        ]
    };

    async function handlePhotos(event) {
        const files = event.target.files;
        
        if (uploadedPhotos.length + files.length > 6) {
            alert('Maximum 6 photos allowed');
            return;
        }

        const statusDiv = document.getElementById('photoStatus');
        statusDiv.innerHTML = '<p>Uploading photos... Please wait.</p>';

        for (let file of files) {
            if (file.size > 5 * 1024 * 1024) {
                alert(`File ${file.name} is too large. Please keep files under 5MB`);
                continue;
            }

            try {
                const uploadedUrl = await uploadToImgBB(file);
                if (uploadedUrl) {
                    uploadedPhotos.push({
                        url: uploadedUrl,
                        name: file.name
                    });
                    updatePhotoPreview();
                    updatePhotoStatus();
                }
            } catch (error) {
                console.error('Upload failed:', error);
                alert(`Failed to upload ${file.name}. Please try again.`);
            }
        }
    }

    async function uploadToImgBB(file) {
        const formData = new FormData();
        formData.append('image', file);

        try {
            const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            
            if (data.success) {
                return data.data.url;
            } else {
                throw new Error(data.error?.message || 'Upload failed');
            }
        } catch (error) {
            console.error('ImgBB upload error:', error);
            throw error;
        }
    }

    function updatePhotoPreview() {
        const preview = document.getElementById('photoPreview');
        preview.innerHTML = uploadedPhotos.map((photo, index) => `
            <div class="photo-preview-item">
                <img src="${photo.url}" alt="Preview">
                <button class="remove-photo" onclick="removePhoto(${index})">×</button>
            </div>
        `).join('');

        updatePhotoTab();
    }

    function removePhoto(index) {
        uploadedPhotos.splice(index, 1);
        updatePhotoPreview();
        updatePhotoStatus();
    }

    function updatePhotoStatus() {
        const statusDiv = document.getElementById('photoStatus');
        statusDiv.innerHTML = `
            <div class="photo-status">
                <p><strong>Uploaded photos:</strong> ${uploadedPhotos.length} of 6 maximum</p>
                <p class="photo-note">Photos are stored securely on ImgBB</p>
                ${uploadedPhotos.map(photo => `
                    <p class="photo-url">✓ ${photo.name} uploaded successfully</p>
                `).join('')}
            </div>
        `;
    }

    function updatePhotoTab() {
        const grid = document.getElementById('photoGrid');
        if (grid) {
            grid.innerHTML = uploadedPhotos.map(photo => `
                <div class="photo-item">
                    <img src="${photo.url}" alt="Update photo">
                    <div class="photo-caption">${photo.name}</div>
                </div>
            `).join('');
        }
    }

    function loadSample() {
        document.getElementById('title').value = sampleData.title;
        document.getElementById('location').value = sampleData.location;
        document.getElementById('story').value = sampleData.story;
        document.getElementById('impact').value = sampleData.impact;
        document.getElementById('prayer').value = sampleData.prayer;
        uploadedPhotos = sampleData.photos;
        updatePhotoPreview();
        updatePhotoStatus();
        showPreview();
    }

    function showPreview() {
        const preview = document.getElementById('preview');
        preview.classList.add('visible');

        document.getElementById('previewTitle').textContent = document.getElementById('title').value;
        document.getElementById('previewLocation').textContent = document.getElementById('location').value;

        document.getElementById('storyTab').innerHTML = `<p>${document.getElementById('story').value.replace(/\n/g, '<br>')}</p>`;
        document.getElementById('impactTab').innerHTML = `<p>${document.getElementById('impact').value.replace(/\n/g, '<br>')}</p>`;
        document.getElementById('prayerTab').innerHTML = `<p>${document.getElementById('prayer').value.replace(/\n/g, '<br>')}</p>`;
        
        updatePhotoTab();
        startRotation();
    }

    function switchTab(tabId) {
        if (rotationInterval) {
            clearInterval(rotationInterval);
        }

        document.querySelectorAll('.tab').forEach(tab => {
            tab.classList.remove('active');
            if (tab.getAttribute('onclick').includes(tabId)) {
                tab.classList.add('active');
            }
        });

        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(tabId).classList.add('active');
    }

    function startRotation() {
        if (rotationInterval) {
            clearInterval(rotationInterval);
        }

        const tabs = ['storyTab', 'photosTab', 'impactTab', 'prayerTab', 'supportTab'];
        let currentIndex = 0;

        rotationInterval = setInterval(() => {
            currentIndex = (currentIndex + 1) % tabs.length;
            switchTab(tabs[currentIndex]);
        }, 4000);
    }

    // Initialize with sample data on page load
    window.onload = loadSample;
</script>
